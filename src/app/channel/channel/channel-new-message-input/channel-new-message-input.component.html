<div
  class="new-message-container"
  [ngClass]="uploadService.channelFileChosen ? 'img-input-height' : ''"
>
  @if (this.uploadService.channelFileChosen) {
  <img [src]="this.uploadService.currentImg$ | async" alt="" />
  <mat-icon
    (click)="this.uploadService.removeImg()"
    class="close-icon pos-relative"
    >close</mat-icon
  >
  }@else {
  <textarea
    [(ngModel)]="messageText"
    matInput
    type="text"
    placeholder="Nachricht an {{ channel.channelName }}"
    rows="3"
    (keydown)="onKeyDown($event)"
  ></textarea>
  }

  <div class="message-controls">
    <div class="add-elements">
      <button
        (click)="this.uploadService.triggerFileInput('file-upload')"
        class="mini-fab-button"
        mat-mini-fab
        class="add-doc mini-fab-btn"
      >
        <input
          id="file-upload"
          type="file"
          (change)="chooseFile($event)"
          [accept]="uploadService.acceptedFileTypes"
          hidden
        />
        <mat-icon>add</mat-icon>
      </button>
      <div class="vertical-divider"></div>
      <button
        mat-mini-fab
        class="emojis mini-fab-btn"
        (click)="openEmojiSet($event)"
      >
        <mat-icon>sentiment_satisfied</mat-icon>
        <div
          *ngIf="isEmoji"
          class="emoji-container"
          appClickOutside
          (clickOutside)="closeEmojiSet()"
        >
          <app-emoji-picker
            (emojiSelected)="onEmojiSelected($event)"
          ></app-emoji-picker>
        </div>
      </button>
      <div>
        <button
          mat-mini-fab
          class="tag-person mini-fab-btn"
          (click)="openPopup($event)"
        >
          <mat-icon>alternate_email</mat-icon>
        </button>
        <app-tagging *ngIf="isTag" (closePopup)="closePopup()"> </app-tagging>
      </div>
    </div>
    <button
      class="send-btn"
      [ngClass]="{ 'send-btn-valid': messageText.trim().length > 0 }"
      (click)="sendMessage()"
    >
      <mat-icon>send</mat-icon>
    </button>
  </div>
</div>
